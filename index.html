<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8">
   
    
    <title>Graphics</title>
</head>    
    <body>
       
             <h1>GRAPHICS</h1>
        <h2>для правильного ввода функции вводите: y = f(x)</h2>
<canvas width="600" height="600" id="canvas"></canvas>
        <div class="enter">
<input id=txt type=text placeholder=" введите функцию y=... " />
            </div>
<button onclick="clearcanvas(); myFunction();draw()"> нарисовать график </button> 
        <div class="clear">
<button onclick="clearcanvas(); razmetka_st()">clear</button>
            </div>
<!--        <button onclick="clear()"> очистить </button> -->
        

                <table>
                    <tr>
                        <td style="padding-right: 5px;">интервал X:</td>
                        <td>
                            
                                [ <input type="text" id="AxisXMinVal"  name="AxisXMinVal" value="-10" />,
                                <input type="text" id="AxisXMaxVal"  name="AxisXMaxVal" value="10" /> ]
                             
                            
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-right: 5px;">интервал Y:</td>
                        <td>
                            
                                [ <input type="text" id="AxisYMinVal"  name="AxisYMinVal" value="-10" />,
                                <input type="text" id="AxisYMaxVal"  name="AxisYMaxVal" value="10" /> ]
                            <label for="AxisYMinMaxValAuto">
                                        <input type="checkbox" id="AxisYMinMaxValAuto" name="AxisYMinMaxValAuto" onclick="check()" style="margin-left: 10px; vertical-align: middle; margin-bottom: 5px;" />
                                        авто
                                    </label>
                            
                        </td>
                    </tr>
     </table>
   
       
<script>
    
    
   
    function cos(x) {
        return Math.cos(x);
    }
    function sin(x){
        return Math.sin(x);
    } 
   function tg(x){
        return Math.tan(x);
    } 
    function ctg(x){
        return 1/Math.tan(x);
    } 
    function sqrt(x){
        return Math.sqrt(x);
    } 
    let step;
    let step1;
    let cnvs = document.querySelector('canvas')
    let ctx = cnvs.getContext('2d')
 
    function clearcanvas(){
   ctx.clearRect(0, 0, canvas.width, canvas.height);
//           ctx.clearRect(0, 0, canvas.width, canvas.height);
       
    }
    function razmetka_st(){//разметка
        
        var input1 = document.getElementById('AxisXMinVal').value;
        var input2 = document.getElementById('AxisXMaxVal').value;
        document.getElementById('AxisXMinVal').value.innerHTML=input1;
         document.getElementById('AxisXMaxVal').value.innerHTML=input2;
        var input3 = document.getElementById('AxisYMinVal').value;
        var input4 = document.getElementById('AxisYMaxVal').value;
        document.getElementById('AxisYMinVal').value.innerHTML=input3;
         document.getElementById('AxisYMaxVal').value.innerHTML=input4;
        //вертикальные
        
       for(var i = cnvs.width/2;i<=cnvs.width;i+=step){
        ctx.beginPath();
        ctx.strokeStyle = '#7a7979';
        ctx.lineWidth = 0.5;
        ctx.moveTo(i, 0);
        ctx.lineTo(i, cnvs.height);
        ctx.closePath();
        ctx.stroke();
       }
        for(var i = cnvs.width/2-step;i>=0;i-=step){
        ctx.beginPath();
        ctx.strokeStyle = '#7a7979';
        ctx.lineWidth = 0.5;
        ctx.moveTo(i, 0);
        ctx.lineTo(i, cnvs.height);
        ctx.closePath();
        ctx.stroke();
       }
        //горизонтальные
        for(var i = cnvs.width/2;i<=cnvs.width;i+=step){
        ctx.beginPath();
        ctx.strokeStyle = 'blue';
        ctx.lineWidth = 0.5;
        ctx.moveTo(i, cnvs.height + step1*document.getElementById('AxisYMinVal').value-5);
     ctx.lineTo(i, cnvs.height + step1*document.getElementById('AxisYMinVal').value+5);
        ctx.closePath();
        ctx.stroke();
       }
        for(var i = cnvs.width/2-step;i>=0;i-=step){
        ctx.beginPath();
        ctx.strokeStyle = 'blue';
        ctx.lineWidth = 0.5;
        ctx.moveTo(i, cnvs.height + step1*document.getElementById('AxisYMinVal').value-5);
       ctx.lineTo(i, cnvs.height + step1*document.getElementById('AxisYMinVal').value+5);
        ctx.closePath();
        ctx.stroke();
       }
        
    for(var i = cnvs.width/2;i<=cnvs.width;i+=step1){
        ctx.beginPath();
        ctx.strokeStyle = '#7a7979';
        ctx.moveTo(0, i);
        ctx.lineTo(cnvs.width, i);
        ctx.closePath();
        ctx.stroke();
    }
        for(var i = cnvs.width/2-step1;i>=0;i-=step1){
        ctx.beginPath();
        ctx.strokeStyle = '#7a7979';
        ctx.moveTo(0, i);
        ctx.lineTo(cnvs.width, i);
        ctx.closePath();
        ctx.stroke();
    }

for(var i = cnvs.width/2; i<=cnvs.width; i+=step1){//гор риски
        ctx.beginPath();
        ctx.strokeStyle = 'blue';
        ctx.moveTo(cnvs.width -step*document.getElementById('AxisXMaxVal').value-5,i);
        ctx.lineTo( cnvs.width -step*document.getElementById('AxisXMaxVal').value+5, i);
        ctx.closePath();
        ctx.stroke();
    }
     for(var i = cnvs.width/2-step1; i>=0; i-=step1){//гор риски
        ctx.beginPath();
        ctx.strokeStyle = 'blue';
        ctx.moveTo(cnvs.width -step*document.getElementById('AxisXMaxVal').value-5,i);
        ctx.lineTo( cnvs.width -step*document.getElementById('AxisXMaxVal').value+5, i);
        ctx.closePath();
        ctx.stroke();
    }

//Ось X 
var input3 = document.getElementById('AxisYMinVal').value;
var input4 = document.getElementById('AxisYMaxVal').value;
document.getElementById('AxisYMinVal').value.innerHTML=input3;
document.getElementById('AxisYMaxVal').value.innerHTML=input4;
ctx.beginPath();
ctx.moveTo(0, cnvs.height + step1*document.getElementById('AxisYMinVal').value);
ctx.lineTo(cnvs.width, cnvs.height + step1*document.getElementById('AxisYMinVal').value);
ctx.strokeStyle = 'red';
ctx.lineWidth = 2;
ctx.closePath();
ctx.stroke()
    
    // ось Y
var input1 = document.getElementById('AxisXMinVal').value;
  
        var input2 = document.getElementById('AxisXMaxVal').value;
  
        document.getElementById('AxisXMinVal').value.innerHTML=input1;
         document.getElementById('AxisXMaxVal').value.innerHTML=input2;
ctx.beginPath();
ctx.moveTo(cnvs.width -step*document.getElementById('AxisXMaxVal').value, 0)
//ctx.moveTo(cnvs.width/2, 0);
ctx.lineTo(cnvs.width -step*document.getElementById('AxisXMaxVal').value, cnvs.height);
ctx.strokeStyle = 'red';
ctx.closePath();
ctx.stroke();



 //график           

    }

        
       
    
    function myFunction() {// определяет шаг
         var input1 = Number(document.getElementById('AxisXMinVal').value);
  //console.log(input1)
        var input2 = Number(document.getElementById('AxisXMaxVal').value);
  //console.log(input2)
        document.getElementById('AxisXMinVal').value.innerHTML=input1;
         document.getElementById('AxisXMaxVal').value.innerHTML=input2;
        var input3 = Number(document.getElementById('AxisYMinVal').value);
  
        var input4 = Number(document.getElementById('AxisYMaxVal').value);
  
        document.getElementById('AxisYMinVal').value.innerHTML=input3;
         document.getElementById('AxisYMaxVal').value.innerHTML=input4;
        //console.log(document.getElementById('AxisXMaxVal').value)
        
        //вычислене шага при значениях больше нуля
        if(input1>=0 && input1<input2){ 
           step = cnvs.height/(input2 - input1);
            console.log(step)
//            let output = (document.getElementById('AxisXMaxVal').value + document.getElementById('AxisXMinVal').value)
//            console.log(output)
           }
        if(input3>=0 && input3<input4 ){
            step1 = cnvs.height/(input4 - input3);
        }
            //вычисление шага, если - и +
            if(input4>=0 && input3<0){
                step1 = cnvs.height/(input4 - input3);
            }
            if(input2>=0 && input1<0){
                step = cnvs.height/(input2 - input1);
            }
            //шаг - - 
            if(input4<0 && input4>input3){
                step1 = cnvs.height/(-(input4 + input3));
            }
            if(input2<0 && input2>input1){
                step = cnvs.height/(-(input2 + input1));
            }
           //
        console.log(step)
            console.log(step1)
       // console.log(input2)
           // console.log(input4)
        //console.log(cnvs.height)
            
//        }else if(document.getElementById('AxisYMinVal').value>0 && document.getElementById("AxisXMaxVal").value>document.getElementById("AxisYMinVal").value){
//     step = cnvs.height/(document.getElementById("AxisXMaxVal").value - document.getElementById("AxisXMinVal").value);
//    step1 = cnvs.height/(document.getElementById("AxisYMaxVal").value - document.getElementById("AxisYMinVal").value);}
//        else if()
        
        razmetka_st();         
    }
    
   myFunction();
    
    

   // cw / 2 / step

//
//      var input1 = document.getElementById('AxisXMaxVal').value;
// document.getElementById('AxisXMaxVal').value.innerHTML=input1;
//    var input2 = document.getElementById('AxisXMinVal').value;
// document.getElementById('AxisXMinVal').value.innerHTML=input2;
function draw(){//рисует график
    var input1 = Number(document.getElementById('AxisXMinVal').value);
        var input2 = Number(document.getElementById('AxisXMaxVal').value);
        document.getElementById('AxisXMinVal').value.innerHTML=input1;
         document.getElementById('AxisXMaxVal').value.innerHTML=input2;
        var input3 = Number(document.getElementById('AxisYMinVal').value);
        var input4 = Number(document.getElementById('AxisYMaxVal').value);
    document.getElementById('AxisYMinVal').value.innerHTML=input3;
         document.getElementById('AxisYMaxVal').value.innerHTML=input4;
    var cw = canvas.width, ch = canvas.height;
//    var t;
//    var t1;
    for(x = -cw / 2 / step; x < input2; x += 1 / step/10){
       eval(document.getElementById("txt").value);
        ctx.fillStyle = 'green';
//        t=y;
//        for(x = -cw / 2 / step +  1 / step/10;x < input2;x += 1 / step/10){
//           t1 = eval(document.getElementById("txt").value);
//            if(t1>t){
//               t = t1
//            }else{
//                
//            }
//            if()
//       }

      
//        
        ctx.fillRect(x * step + cnvs.width -step*document.getElementById('AxisXMaxVal').value, ch -(y * step1  - step1*document.getElementById('AxisYMinVal').value), 2, 2);
        
        
       //}
        
    }
}
    

    var i =false;
   function check(){
       var d;
      
       
//       for(x = -cnvs.width / 2 / step; x < document.getElementById('AxisXMaxVal').value; x += 1 / step/10){
//        d = eval(document.getElementById("txt").value);
//           for(x = -cnvs.width / 2 / step;x < document.getElementById('AxisXMaxVal').value; x += 1 / step/10){
//               d1 = eval(document.getElementById("txt").value);
//               if(d>d1){
//           AxisYMaxVal.disabled = 1;
//       AxisYMinVal.disabled = 1;
//    document.getElementById('AxisYMaxVal').value = d;
//    //document.getElementById('AxisYMinVal').value = d1;
//       }else{
//           AxisYMaxVal.disabled = 1;
//       AxisYMinVal.disabled = 1;
//    document.getElementById('AxisYMaxVal').value = d1;
//    //document.getElementById('AxisYMinVal').value = d;
//       }
//           }
//       }
//       
      if(i == false){
      AxisYMaxVal.disabled = 1;
       AxisYMinVal.disabled = 1;
      i = true;
      }  else{
          AxisYMaxVal.disabled = 0;
       AxisYMinVal.disabled = 0; 
           i =false;
       }    
       let arr = [];
       for(x = -cnvs.width / 2 / step;x < document.getElementById('AxisXMaxVal').value; x += 1 / step/10){
           d = eval(document.getElementById("txt").value);
           arr.push(d)
           
          
       }
       document.getElementById('AxisYMinVal').value=Math.round(Math.min.apply(null, arr));
       document.getElementById('AxisYMaxVal').value = Math.round(Math.max.apply(null, arr))
//       console.log(Math.round(Math.max.apply(null, arr)))
//       console.log(Math.round(Math.min.apply(null, arr)))
    
       }
     
       
       
       
       
//       if(i == false){
//      AxisYMaxVal.disabled = 1;
//       AxisYMinVal.disabled = 1;
//           x = document.getElementById('AxisXMaxVal').value;
//           var z = eval(document.getElementById("txt").value);
//           
//             console.log(z);
//          x = document.getElementById('AxisXMinVal').value;
//           var z1 = eval(document.getElementById("txt").value);
//           console.log(z1);
//           
//           if((z1 == z) && z1>0){
//               console.log('q')
//           document.getElementById('AxisYMinVal').value = 0;
//           document.getElementById('AxisYMaxVal').value = z;
//           }else{
//                console.log('q')
//           document.getElementById('AxisYMinVal').value = z1;
//           document.getElementById('AxisYMaxVal').value = z;
//           }
//           if(z<z1){
//               var z2 = z;
//               z = z1;
//           document.getElementById('AxisYMinVal').value = z2;
//           console.log(document.getElementById('AxisYMinVal').value)
//           document.getElementById('AxisYMaxVal').value = z;
//           }
//           if((z1 == z) && z1<0){
//                console.log('q')
//           document.getElementById('AxisYMinVal').value = z;
//           document.getElementById('AxisYMaxVal').value = 0;
//           }
//           
//           i = true;
//       }else{
//          AxisYMaxVal.disabled = 0;
//       AxisYMinVal.disabled = 0; 
//           i =false;
//       }
   




        </script>
    </body>
</html>